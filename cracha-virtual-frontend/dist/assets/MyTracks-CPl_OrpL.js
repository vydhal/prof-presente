import{f as W,r as z,j as e,M as Y,a2 as J,F as Z,o as ee,R as ae,p as M,q as se,c as L,aH as A,aE as E,B as u,C as te,L as re,v as p,aJ as b}from"./index-D96FZGJW.js";import{C as _,a as S,b as R,c as V,d as F,e as T}from"./card-DGXvG8EM.js";import{B as f}from"./badge-B3h_Dmat.js";import{D as le,b as ie,c as oe,d as ne,e as de,f as ce}from"./dialog-Bl-WjPsE.js";import{A as xe}from"./index-vetFhh_T.js";import{C as U}from"./circle-check-BwwNu7gD.js";import{A as ue}from"./arrow-right-Dh0o9ikH.js";import{M as he}from"./map-pin-DIXgTodH.js";/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],q=W("book-open",me);var v="Progress",j=100,[ge]=Y(v),[pe,be]=ge(v),G=z.forwardRef((s,r)=>{const{__scopeProgress:n,value:d=null,max:t,getValueLabel:m=fe,...x}=s;(t||t===0)&&!O(t)&&console.error(ve(`${t}`,"Progress"));const c=O(t)?t:j;d!==null&&!B(d,c)&&console.error(je(`${d}`,"Progress"));const l=B(d,c)?d:null,N=h(l)?m(l,c):void 0;return e.jsx(pe,{scope:n,value:l,max:c,children:e.jsx(J.div,{"aria-valuemax":c,"aria-valuemin":0,"aria-valuenow":h(l)?l:void 0,"aria-valuetext":N,role:"progressbar","data-state":K(l,c),"data-value":l??void 0,"data-max":c,...x,ref:r})})});G.displayName=v;var H="ProgressIndicator",Q=z.forwardRef((s,r)=>{const{__scopeProgress:n,...d}=s,t=be(H,n);return e.jsx(J.div,{"data-state":K(t.value,t.max),"data-value":t.value??void 0,"data-max":t.max,...d,ref:r})});Q.displayName=H;function fe(s,r){return`${Math.round(s/r*100)}%`}function K(s,r){return s==null?"indeterminate":s===r?"complete":"loading"}function h(s){return typeof s=="number"}function O(s){return h(s)&&!isNaN(s)&&s>0}function B(s,r){return h(s)&&!isNaN(s)&&s<=r&&s>=0}function ve(s,r){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${r}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${j}\`.`}function je(s,r){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${r}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${j} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Ne=G,ke=Q;function we({className:s,value:r,...n}){return e.jsx(Ne,{"data-slot":"progress",className:Z("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",s),...n,children:e.jsx(ke,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(r||0)}%)`}})})}const Ae=()=>{var w,y;const s=ee(),[r,n]=ae.useState(null),d=a=>{const i=JSON.parse(localStorage.getItem("user")),o=i==null?void 0:i.id;if(!o){p.error("Erro ao identificar usuário");return}window.open(`http://localhost:3000/api/certificates/track/${a}/user/${o}`,"_blank")},{data:t,isLoading:m}=M({queryKey:["my-tracks"],queryFn:async()=>(await b.getMy()).data}),{data:x,isLoading:c}=M({queryKey:["all-tracks"],queryFn:async()=>(await b.getAll()).data}),l=se({mutationFn:a=>b.enroll(a),onSuccess:()=>{s.invalidateQueries(["my-tracks"]),p.success("Inscrição realizada com sucesso!")},onError:a=>{var i,o;p.error(((o=(i=a.response)==null?void 0:i.data)==null?void 0:o.error)||"Erro ao se inscrever")}});if(m||c)return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] space-y-4",children:[e.jsx(L,{className:"w-12 h-12 text-blue-500 animate-spin"}),e.jsx("p",{className:"text-slate-500 font-medium animate-pulse",children:"Carregando suas trilhas..."})]});const X=(t==null?void 0:t.map(a=>a.trackId))||[],k=(x==null?void 0:x.filter(a=>!X.includes(a.id)))||[];return e.jsxs("div",{className:"container mx-auto py-8 px-4 max-w-7xl",children:[e.jsxs("header",{className:"mb-12",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(A,{className:"w-6 h-6 text-blue-500"})}),e.jsx("h1",{className:"text-4xl font-black tracking-tight text-slate-900 dark:text-white",children:"Formação Continuada"})]}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-lg",children:"Acompanhe seu progresso nas trilhas de conhecimento."})]}),e.jsxs("section",{className:"mb-16",children:[e.jsx("div",{className:"flex items-center justify-between mb-8",children:e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:["Minhas Trilhas",e.jsx(f,{variant:"secondary",className:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",children:(t==null?void 0:t.length)||0})]})}),(t==null?void 0:t.length)===0?e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-900/50 border-2 border-dashed border-slate-200 dark:border-slate-800 rounded-3xl p-12 text-center",children:[e.jsx(q,{className:"w-12 h-12 text-slate-300 dark:text-slate-700 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-slate-700 dark:text-slate-300",children:"Nenhuma trilha iniciada"}),e.jsx("p",{className:"text-slate-500 mt-2 italic",children:"Escolha uma trilha abaixo para começar sua jornada."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.jsx(xe,{children:t==null?void 0:t.map((a,i)=>e.jsx(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:i*.1},children:e.jsxs(_,{className:"overflow-hidden group hover:shadow-2xl hover:shadow-blue-500/10 transition-all duration-300 border-slate-200 dark:border-slate-800 bg-white/50 dark:bg-slate-950/50 backdrop-blur-xl",children:[e.jsxs("div",{className:"h-40 bg-slate-100 dark:bg-slate-900 relative",children:[a.track.imageUrl?e.jsx("img",{src:a.track.imageUrl,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500",alt:a.track.title}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-blue-500 to-indigo-600",children:e.jsx(A,{className:"w-16 h-16 text-white/20"})}),e.jsx("div",{className:"absolute top-4 right-4",children:a.isCompleted?e.jsxs(f,{className:"bg-green-500 text-white border-none px-3 py-1 flex gap-1",children:[e.jsx(U,{className:"w-3 h-3"})," Concluído"]}):e.jsx(f,{className:"bg-blue-500 text-white border-none px-3 py-1",children:"Em Progresso"})})]}),e.jsxs(S,{className:"pb-3",children:[e.jsx(R,{className:"text-xl font-black tracking-tight group-hover:text-blue-500 transition-colors",children:a.track.title}),e.jsx(V,{className:"line-clamp-2 min-h-[3rem]",children:a.track.description})]}),e.jsxs(F,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-xs font-bold uppercase tracking-wider text-slate-500",children:[e.jsx("span",{children:"Progresso"}),e.jsxs("span",{className:`${a.isCompleted?"text-green-500":"text-blue-500"}`,children:[Math.round(a.progress),"%"]})]}),e.jsx(we,{value:a.progress,className:`h-2 ${a.isCompleted?"bg-green-100 dark:bg-green-950/30":""}`})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-slate-500",children:[e.jsx(ue,{className:"w-4 h-4 text-blue-500"}),e.jsxs("span",{children:[a.track._count.events," Etapas no total"]})]})]}),e.jsx(T,{className:"pt-0",children:e.jsx(u,{variant:"outline",onClick:()=>a.isCompleted?d(a.trackId):n(a),className:"w-full rounded-xl font-bold group-hover:bg-blue-500 group-hover:text-white group-hover:border-blue-500 transition-all font-bold",children:a.isCompleted?"Visualizar Certificado":"Ver Minha Jornada"})})]})},a.id))})})]}),k.length>0&&e.jsxs("section",{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Trilhas Disponíveis"}),e.jsx("p",{className:"text-slate-500",children:"Explore novas formações para sua trilha profissional."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:k.map((a,i)=>e.jsx(E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.2+i*.1},children:e.jsxs(_,{className:"h-full flex flex-col border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-950 overflow-hidden group",children:[e.jsx("div",{className:"h-32 bg-slate-200 dark:bg-slate-900 overflow-hidden",children:a.imageUrl?e.jsx("img",{src:a.imageUrl,className:"w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-500",alt:""}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-100 dark:bg-slate-900",children:e.jsx(q,{className:"w-10 h-10 text-slate-300 dark:text-slate-700"})})}),e.jsxs(S,{className:"flex-1 pb-4",children:[e.jsx(R,{className:"text-lg font-bold leading-tight line-clamp-2",children:a.title}),e.jsx(V,{className:"line-clamp-3 text-xs leading-relaxed",children:a.description})]}),e.jsx(F,{className:"pb-4 pt-0",children:e.jsx("div",{className:"flex items-center justify-between text-xs text-slate-500 font-bold uppercase tracking-widest",children:e.jsxs("span",{children:[a._count.events," Etapas"]})})}),e.jsx(T,{className:"pt-0",children:e.jsx(u,{onClick:()=>l.mutate(a.id),disabled:l.isLoading,className:"w-full bg-slate-900 dark:bg-white dark:text-slate-900 font-black rounded-xl hover:bg-blue-600 dark:hover:bg-blue-500 hover:text-white transition-all",children:l.isLoading&&l.variables===a.id?e.jsx(L,{className:"w-4 h-4 animate-spin"}):"Começar Agora"})})]})},a.id))})]}),e.jsx(le,{open:!!r,onOpenChange:()=>n(null),children:e.jsxs(ie,{className:"max-w-md bg-white dark:bg-slate-950 border-slate-200 dark:border-slate-800 rounded-3xl p-6",children:[e.jsxs(oe,{children:[e.jsx(ne,{className:"text-2xl font-black",children:"Sua Jornada"}),e.jsxs(de,{children:["Complete todos os eventos abaixo para concluir a trilha: ",e.jsx("br",{}),e.jsx("span",{className:"font-bold text-blue-500",children:r==null?void 0:r.track.title})]})]}),e.jsx("div",{className:"py-4 space-y-4 max-h-[60vh] overflow-y-auto pr-2",children:((y=(w=r==null?void 0:r.track)==null?void 0:w.events)==null?void 0:y.map((a,i)=>{var g,C,P,$,D,I;const o=((C=(g=a.event)==null?void 0:g.userCheckins)==null?void 0:C.length)>0;return e.jsxs("div",{className:`flex items-start gap-3 p-4 rounded-2xl border transition-all ${o?"bg-green-50/50 dark:bg-green-900/10 border-green-100 dark:border-green-900/30":"bg-slate-50 dark:bg-slate-900/50 border-slate-100 dark:border-slate-800"}`,children:[e.jsx("div",{className:`mt-1 p-1.5 rounded-full ${o?"bg-green-500 text-white":"bg-slate-200 dark:bg-slate-800 text-slate-400"}`,children:o?e.jsx(U,{className:"w-4 h-4"}):e.jsx("div",{className:"w-4 h-4 flex items-center justify-center font-bold text-[10px]",children:i+1})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:`font-bold text-sm line-clamp-1 ${o?"text-green-700 dark:text-green-400":"text-slate-900 dark:text-white"}`,children:(P=a.event)==null?void 0:P.title}),e.jsxs("div",{className:"flex flex-col gap-1 mt-1",children:[e.jsxs("p",{className:"text-xs text-slate-500 flex items-center gap-1",children:[e.jsx(te,{className:"w-3 h-3"}),($=a.event)!=null&&$.startDate?new Date(a.event.startDate).toLocaleDateString():"Data não definida"]}),e.jsxs("p",{className:"text-xs text-slate-500 flex items-center gap-1",children:[e.jsx(he,{className:"w-3 h-3"}),((D=a.event)==null?void 0:D.location)||"Local não definido"]})]})]}),!o&&((I=a.event)==null?void 0:I.id)&&e.jsx(re,{to:`/events/${a.event.id}`,children:e.jsx(u,{size:"sm",variant:"ghost",className:"text-blue-500 hover:text-blue-600 hover:bg-blue-50 dark:hover:bg-blue-900/20 px-2 h-8",children:"Ver Evento"})})]},a.id||`${a.trackId}-${a.eventId}`)}))||e.jsx("div",{className:"text-center py-8 text-slate-500 italic",children:"Nenhum evento vinculado a esta trilha."})}),e.jsx(ce,{children:e.jsx(u,{className:"w-full rounded-xl bg-blue-600 hover:bg-blue-700 text-white font-bold",onClick:()=>n(null),children:"Entendido"})})]})})]})};export{Ae as default};
