import{r as f,j as e,L as c,B as i,C,S as y,e as b}from"./index-BklJB83-.js";import{u as w}from"./useInfiniteQuery-CGxVA1cM.js";import{C as E,a as P,b as D,c as T,d as B}from"./card-DDG5aQ8T.js";import{B as h}from"./badge-nwE1jcP_.js";import{T as L,a as R,b as r,c as A}from"./tabs-CexLezTw.js";import{M}from"./map-pin-DL_mMyFw.js";import{C as S}from"./clock-Bmn6bzuq.js";const O=()=>{const[t,g]=f.useState("all"),{data:l,error:d,isLoading:o,fetchNextPage:j,hasNextPage:u,isFetchingNextPage:x}=w({queryKey:["my-enrollments",t],queryFn:async({pageParam:s=1})=>(await b.get("/enrollments/my-enrollments",{params:{page:s,limit:6,status:t==="all"?void 0:t.toUpperCase()}})).data,getNextPageParam:s=>{const{page:a,pages:N}=s.pagination;return a<N?a+1:void 0}}),n=(l==null?void 0:l.pages.flatMap(s=>s.enrollments))??[],m=s=>new Date(s).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"UTC"}),p=s=>{const a={PENDING:{label:"Pendente",color:"bg-yellow-100 text-yellow-800"},APPROVED:{label:"Aprovada",color:"bg-green-100 text-green-800"},REJECTED:{label:"Rejeitada",color:"bg-red-100 text-red-800"},CANCELLED:{label:"Cancelada",color:"bg-gray-100 text-gray-800"}};return a[s]||a.PENDING},v=({enrollment:s})=>{const a=p(s.status);return e.jsxs(E,{className:"hover:shadow-lg transition-shadow",children:[e.jsxs(P,{children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{className:"text-lg line-clamp-2",children:s.event.title}),s.event.isPrivate&&e.jsx(h,{variant:"secondary",children:"Privado"})]}),e.jsx(h,{className:a.color,children:a.label})]}),e.jsx(T,{className:"line-clamp-3",children:s.event.description})]}),e.jsx(B,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:m(s.event.startDate)})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"line-clamp-1",children:s.event.location})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),e.jsxs("span",{children:["Inscrito em ",m(s.enrollmentDate)]})]}),e.jsxs("div",{className:"pt-2 flex gap-2",children:[e.jsx(c,{to:`/events/${s.event.id}`,className:"flex-1",children:e.jsx(i,{variant:"outline",className:"w-full",children:"Ver evento"})}),s.status==="APPROVED"&&!s.courseEvaluation&&e.jsx(c,{to:`/evaluate/${s.id}`,id:"evaluate-enrollment-button",children:e.jsxs(i,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-4 w-4"}),"Avaliar"]})})]})]})})]})};return o&&!l?e.jsx("div",{children:"Carregando inscrições..."}):d?e.jsxs("div",{className:"text-center text-red-600",children:["Erro ao carregar inscrições: ",d.message]}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Minhas Inscrições"}),e.jsxs(L,{value:t,onValueChange:g,children:[e.jsx("div",{className:"w-full overflow-x-auto pb-2 scrollbar-thin",children:e.jsxs(R,{className:"inline-flex w-auto space-x-2 sm:grid sm:w-full sm:grid-cols-5",children:[e.jsx(r,{value:"all",children:"Todas"}),e.jsx(r,{value:"approved",children:"Aprovadas"}),e.jsx(r,{value:"pending",children:"Pendentes"}),e.jsx(r,{value:"rejected",children:"Rejeitadas"}),e.jsx(r,{value:"cancelled",children:"Canceladas"})]})}),e.jsx(A,{value:t,className:"mt-4",children:o&&n.length===0?e.jsx("p",{children:"Carregando..."}):n.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:t==="all"?"Você ainda não se inscreveu em nenhum evento.":`Nenhuma inscrição com o status "${t}".`}),e.jsx(c,{to:"/events",children:e.jsx(i,{children:"Explorar eventos"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(s=>e.jsx(v,{enrollment:s},s.id))}),e.jsx("div",{className:"flex justify-center mt-6",children:u&&e.jsx(i,{onClick:()=>j(),disabled:x,children:x?"Carregando...":"Carregar Mais"})})]})})]})]})};export{O as default};
