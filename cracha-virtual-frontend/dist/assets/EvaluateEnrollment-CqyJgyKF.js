import{n as E,b as w,o as S,r as c,p as M,q as k,j as e,B as r,S as A,v as m,e as y}from"./index-D96FZGJW.js";import{C as d,d as x,a as q,b as I,c as L}from"./card-DGXvG8EM.js";import{T as P}from"./textarea-CEySCzb7.js";import{A as Q}from"./arrow-left-DuJ7_3jW.js";const D=()=>{var p;const{enrollmentId:t}=E(),n=w(),u=S(),[a,f]=c.useState(0),[g,h]=c.useState(0),[o,N]=c.useState(""),{data:v,isLoading:C}=M({queryKey:["enrollment",t],queryFn:async()=>(await y.get(`/enrollments/users/${t}`)).data,enabled:!!t}),l=k({mutationFn:async s=>(await y.post("/evaluations",s)).data,onSuccess:()=>{m.success("Avaliação enviada com sucesso!"),u.invalidateQueries(["my-enrollments"]),u.invalidateQueries(["enrollment",t]),n("/my-enrollments")},onError:s=>{var i,j;m.error(((j=(i=s.response)==null?void 0:i.data)==null?void 0:j.error)||"Erro ao enviar avaliação")}}),b=s=>{if(s.preventDefault(),a===0){m.error("Por favor, selecione uma avaliação");return}l.mutate({enrollmentId:t,rating:a,comment:o.trim()||null})};return C?e.jsx("div",{className:"p-6",children:e.jsx(d,{children:e.jsx(x,{className:"py-12",children:e.jsx("p",{className:"text-center text-gray-500",children:"Carregando..."})})})}):v?e.jsxs("div",{className:"p-6 max-w-2xl mx-auto space-y-6",children:[e.jsxs(r,{variant:"ghost",onClick:()=>n("/my-enrollments"),className:"mb-4",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Voltar"]}),e.jsxs(d,{children:[e.jsxs(q,{children:[e.jsx(I,{children:"Avaliar Evento"}),e.jsx(L,{children:((p=v.event)==null?void 0:p.title)||"Evento"})]}),e.jsx(x,{children:e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-3",children:"Como você avalia este evento?"}),e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>f(s),onMouseEnter:()=>h(s),onMouseLeave:()=>h(0),className:"focus:outline-none transition-transform hover:scale-110",children:e.jsx(A,{className:`h-10 w-10 ${s<=(g||a)?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},s))}),a>0&&e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[a===1&&"Muito insatisfeito",a===2&&"Insatisfeito",a===3&&"Neutro",a===4&&"Satisfeito",a===5&&"Muito satisfeito"]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"comment",className:"block text-sm font-medium mb-2",children:"Comentário (opcional)"}),e.jsx(P,{id:"comment",value:o,onChange:s=>N(s.target.value),placeholder:"Compartilhe sua experiência sobre o evento...",rows:5,maxLength:1e3}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[o.length,"/1000 caracteres"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(r,{type:"submit",disabled:l.isPending||a===0,className:"flex-1",children:l.isPending?"Enviando...":"Enviar Avaliação"}),e.jsx(r,{type:"button",variant:"outline",onClick:()=>n("/my-enrollments"),children:"Cancelar"})]})]})})]})]}):e.jsx("div",{className:"p-6",children:e.jsx(d,{children:e.jsxs(x,{className:"py-12",children:[e.jsx("p",{className:"text-center text-red-600",children:"Inscrição não encontrada"}),e.jsx("div",{className:"text-center mt-4",children:e.jsx(r,{onClick:()=>n("/my-enrollments"),children:"Voltar para Minhas Inscrições"})})]})})})};export{D as default};
