import{r as v,j as e,B as p,m as y,C as j,L as b,e as w}from"./index-BklJB83-.js";import{u as C}from"./useInfiniteQuery-CGxVA1cM.js";import{u as E}from"./useDebounce-w3fuvctn.js";import{C as P,a as D,b as S,c as T,d as U}from"./card-DDG5aQ8T.js";import{I as B}from"./input-D985NYo-.js";import{B as u}from"./badge-nwE1jcP_.js";import{S as F}from"./separator-B7gRSS1v.js";import{S as q}from"./search-BUhK1DE4.js";import{M as A}from"./map-pin-DL_mMyFw.js";import{U as I}from"./users-DkAybG50.js";const f=({event:a})=>{const m=i=>new Date(i).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",timeZone:"America/Sao_Paulo"}),l=((i,x)=>{const r=new Date,c=new Date(i),t=new Date(x),o=14400*1e3;return r<c?{label:"Próximo",color:"bg-blue-100 text-blue-800"}:r>=c&&r<=new Date(t.getTime()+o)?{label:r<=t?"Em andamento":"Finalizado (Recente)",color:r<=t?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}:{label:"Finalizado",color:"bg-gray-100 text-gray-800"}})(a.startDate,a.endDate),n=y(a.imageUrl);return e.jsxs(P,{className:"hover:shadow-lg transition-shadow flex flex-col",children:[n?e.jsx("img",{src:n,alt:a.title,className:"w-full object-cover"}):e.jsx("div",{className:"w-full h-40 bg-gray-200 flex items-center justify-center",children:e.jsx(j,{className:"h-12 w-12 text-gray-400"})}),e.jsxs(D,{children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:"text-lg line-clamp-2",children:a.title}),a.isPrivate&&e.jsx(u,{variant:"secondary",children:"Privado"})]}),e.jsx(u,{className:l.color,children:l.label})]}),e.jsx(T,{className:"line-clamp-3 h-[60px]",children:a.description})]}),e.jsxs(U,{className:"flex-1 flex flex-col justify-between",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:m(a.startDate)})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"line-clamp-1",children:a.location})]}),a.maxAttendees&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),e.jsxs("span",{children:[a.enrolledCount||0," inscritos de ",a.maxAttendees," ","vagas"]})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx(b,{to:`/events/${a.id}`,children:e.jsx(p,{className:"w-full",children:"Ver detalhes"})})})]})]})},_=()=>{const[a,m]=v.useState(""),d=E(a,500),{data:l,error:n,isLoading:i,fetchNextPage:x,hasNextPage:r,isFetchingNextPage:c}=C({queryKey:["events",d],queryFn:async({pageParam:s=1})=>(await w.get("/events",{params:{page:s,limit:9,search:d,upcoming:!0}})).data,getNextPageParam:s=>{const{page:h,pages:N}=s.pagination;return h<N?h+1:void 0}}),t=(l==null?void 0:l.pages.flatMap(s=>s.events))??[],o=t.filter(s=>s.isPrivate),g=t.filter(s=>!s.isPrivate);return i&&t.length===0?e.jsx("div",{className:"p-6",children:"Carregando eventos..."}):n?e.jsxs("div",{className:"p-6 text-center",children:[e.jsxs("p",{className:"text-red-600",children:["Erro ao carregar eventos: ",n.message]}),e.jsx(p,{onClick:()=>window.location.reload(),className:"mt-4",children:"Tentar novamente"})]}):e.jsxs("div",{className:"p-6 space-y-8",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h1",{className:"text-3xl font-bold",children:"Eventos"})}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(B,{placeholder:"Pesquisar por título, descrição ou local...",value:a,onChange:s=>m(s.target.value),className:"pl-10"})]}),t.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-600",children:d?"Nenhum evento encontrado para sua pesquisa.":"Nenhum evento disponível para você no momento."})}):e.jsxs(e.Fragment,{children:[o.length>0&&e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Eventos da sua Unidade"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(s=>e.jsx(f,{event:s},s.id))})]}),o.length>0&&g.length>0&&e.jsx(F,{}),g.length>0&&e.jsxs("section",{id:"events-list",className:"space-y-4",children:[" ",e.jsx("h2",{className:"text-2xl font-bold",children:"Eventos Públicos"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(s=>e.jsx(f,{event:s},s.id))})]})]}),e.jsx("div",{className:"flex justify-center mt-6",children:r&&e.jsx(p,{onClick:()=>x(),disabled:c,children:c?"Carregando...":"Carregar Mais"})})]})};export{_ as default};
